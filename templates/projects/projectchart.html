{% load static %}
{% load widget_tweaks %}

<!DOCTYPE html>
<html lang="en">

	<!-- begin::Head -->
	<head>
		<meta charset="utf-8" />
		<title>Ratings | Project Chart</title>
		<meta name="description" content="Latest updates and statistic charts">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, shrink-to-fit=no">

		<!--begin::Web font -->
		<script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.16/webfont.js"></script>
		

		<!--end::Web font -->

		<!--begin::Global Theme Styles -->
		<link href="{% static 'assets/vendors/base/vendors.bundle.css'%}" rel="stylesheet" type="text/css" />

		<!--RTL version:<link href="../assets/vendors/base/vendors.bundle.rtl.css" rel="stylesheet" type="text/css" />-->
		<link href="{% static 'assets/demo/default/base/style.bundle.css' %}" rel="stylesheet" type="text/css" />
		<link href="{% static 'assets/demo/default/base/custom.css' %}" rel="stylesheet" type="text/css" />
		<!--RTL version:<link href="../assets/demo/default/base/style.bundle.rtl.css" rel="stylesheet" type="text/css" />-->

		<!--end::Global Theme Styles -->

		<!--begin::Page Vendors Styles -->
		<link href="{% static 'assets/vendors/custom/fullcalendar/fullcalendar.bundle.css' %}" rel="stylesheet" type="text/css" />

		<!--RTL version:<link href="../assets/vendors/custom/fullcalendar/fullcalendar.bundle.rtl.css" rel="stylesheet" type="text/css" />-->

		<!--end::Page Vendors Styles -->
		<link rel="shortcut icon" href="{% static 'assets/demo/default/media/img/logo/favicon.ico' %}" />
	</head>

	<!-- end::Head -->

	<!-- begin::Body -->
	<body class="m-page--fluid m--skin- m-content--skin-light2 m-header--fixed m-header--fixed-mobile m-aside-left--enabled m-aside-left--skin-dark m-aside-left--fixed m-aside-left--offcanvas m-footer--push m-aside--offcanvas-default">

		<!-- begin:: Page -->
		<div class="m-grid m-grid--hor m-grid--root m-page">

			<!-- BEGIN: Header -->
			<header id="m_header" class="m-grid__item    m-header " m-minimize-offset="200" m-minimize-mobile-offset="200">
				<div class="m-container m-container--fluid m-container--full-height">
					<div class="m-stack m-stack--ver m-stack--desktop">

						<!-- BEGIN: Brand -->
						<div class="m-stack__item m-brand  m-brand--skin-dark ">
							<div class="m-stack m-stack--ver m-stack--general">
								<div class="m-stack__item m-stack__item--middle m-brand__logo">
									<a href="javascript:void(0)" class="m-brand__logo-wrapper">
										<img style="width: 133px;" alt=""  src="{% static 'assets/demo/default/media/img/logo/mylogo.png' %}">
									</a>
								</div>
								<div class="m-stack__item m-stack__item--middle m-brand__tools">

									<!-- BEGIN: Left Aside Minimize Toggle -->
									<a href="javascript:;" id="m_aside_left_minimize_toggle" class="m-brand__icon m-brand__toggler m-brand__toggler--left m--visible-desktop-inline-block  ">
										<span></span>
									</a>

									<!-- END -->

									<!-- BEGIN: Responsive Aside Left Menu Toggler -->
									<a href="javascript:;" id="m_aside_left_offcanvas_toggle" class="m-brand__icon m-brand__toggler m-brand__toggler--left m--visible-tablet-and-mobile-inline-block">
										<span></span>
									</a>

									<!-- END -->

								
								</div>
							</div>
						</div>

						<!-- END: Brand -->
						
					</div>
				</div>
			</header>

			<!-- END: Header -->

			<!-- begin::Body -->
			<div class="m-grid__item m-grid__item--fluid m-grid m-grid--ver-desktop m-grid--desktop m-body">

				<!-- BEGIN: Left Aside -->
				<button class="m-aside-left-close  m-aside-left-close--skin-dark " id="m_aside_left_close_btn"><i class="la la-close"></i></button>
				<div id="m_aside_left" class="m-grid__item	m-aside-left  m-aside-left--skin-dark ">

					<!-- BEGIN: Aside Menu -->
					<div id="m_ver_menu" class="m-aside-menu  m-aside-menu--skin-dark m-aside-menu--submenu-skin-dark " m-menu-vertical="1" m-menu-scrollable="1" m-menu-dropdown-timeout="500" style="position: relative;">
						<ul class="m-menu__nav  m-menu__nav--dropdown-submenu-arrow ">
							<li class="m-menu__item  m-menu__item--submenu" aria-haspopup="true" m-menu-submenu-toggle="hover"><a href="javascript:;" class="m-menu__link m-menu__toggle"><i class="m-menu__link-icon flaticon-layers"></i><span class="m-menu__link-text">Project</span><i class="m-menu__ver-arrow la la-angle-right"></i></a>
								<div class="m-menu__submenu "><span class="m-menu__arrow"></span>
									<ul class="m-menu__subnav">
										<li class="m-menu__item " aria-haspopup="true"><a href="{% url 'createproject'%}" class="m-menu__link "><i class="m-menu__link-bullet m-menu__link-bullet--dot"><span></span></i><span class="m-menu__link-text">Create Project</span></a></li>
										<li class="m-menu__item " aria-haspopup="true"><a href="{% url 'index' %}" class="m-menu__link "><i class="m-menu__link-bullet m-menu__link-bullet--dot"><span></span></i><span class="m-menu__link-text">View Project</span></a></li>
										
									</ul>
								</div>
							</li>
							<li class="m-menu__item  m-menu__item--active" aria-haspopup="true"><a href="{% url 'single_review'%}" class="m-menu__link "><i class="m-menu__link-icon flaticon-layers"></i><span class="m-menu__link-title"> <span class="m-menu__link-wrap"> <span class="m-menu__link-text">Single Review</span>
											<span class="m-menu__link-badge"></span> </span></span></a></li>
											<form action="{% url 'logout' %}" id="logout" method="post">
												{% csrf_token %}
												<input type="hidden">
											</form>
							<li class="m-menu__item  m-menu__item--active" aria-haspopup="true"><a style="cursor:pointer;" onclick="logout()" class="m-menu__link "><i class="m-menu__link-icon flaticon-layers"></i><span class="m-menu__link-title"> <span class="m-menu__link-wrap"> <span class="m-menu__link-text">Logout</span>
											<span class="m-menu__link-badge"></span> </span></span></a></li>
							
						</ul>
					</div>

					<!-- END: Aside Menu -->
				</div>

				<!-- END: Left Aside -->
				<div class="m-grid__item m-grid__item--fluid m-wrapper">

					<!-- BEGIN: Subheader --
					<div class="m-subheader ">
						<div class="d-flex align-items-center">
							<div class="mr-auto">
								<h3 class="m-subheader__title ">Create Project</h3>
							</div>
						</div>
					</div>

                    <!-- END: Subheader -->
                    {% if project %}
					<div class="m-content">
						<div class="row">
							
							<div class="col-xl-12">

								<!--begin::Portlet-->
								<div class="m-portlet m-portlet--tabs">
									<div class="m-portlet__head">
										<div class="m-portlet__head-caption">
											<div class="m-portlet__head-title">
												<h3 class="m-portlet__head-text fw-800">
													{{project.name}}
												</h3>
											</div>
                                        </div>
                                        
										<div class="m-portlet__head-tools">
											<ul class="nav nav-tabs m-tabs m-tabs-line  m-tabs-line--right" role="tablist">
												<li class="nav-item m-tabs__item">
													<a class="nav-link m-tabs__link active" href="{% url 'projectchart' project.id %}" >
														Overall
													</a>
												</li>
												<li class="nav-item m-tabs__item">
													<a class="nav-link m-tabs__link" href="{% url 'projectcontext' project.id %}">
														Categorized
													</a>
												</li>
												
											</ul>
										</div>
                                    </div>
                                    
									<div class="m-portlet__body" style="min-height: 300px;">
										<div class="tab-content">
											<div class="tab-pane active" id="m_tabs_7_1" role="tabpanel">
                                                <div class="row">
                                                	<div class="col-md-12">
                                                		<div class="m-widget16">
															<div class="row">
																<div class="col-md-12">
																	<h4 class="fw-800">No. of Reviews according to Sentiment</h4>
																	<div class="m-widget16__stats">
																		<div class="m-widget16__visual" id="donutChart">
																			<div id="mydonut" style="height: 220px">
																			</div>
																		</div>
																		<div class="m-widget16__legends">
																			<div class="m-widget16__legend">
																				<span class="m-widget16__legend-bullet m--bg-success"></span>
																				<span class="m-widget16__legend-text positive_donut"></span>
																			</div>
																			<div class="m-widget16__legend">
																				<span class="m-widget16__legend-bullet m--bg-warning"></span>
																				<span class="m-widget16__legend-text neutral_donut"></span>
																			</div>
																			<div class="m-widget16__legend">
																				<span class="m-widget16__legend-bullet m--bg-danger"></span>
																				<span class="m-widget16__legend-text negative_donut"></span>
																			</div>
																		</div>
																	</div>
																</div>
															</div>
														</div>
														
                                                	</div>
                                                	<!--end of donut div-->
                                                </div>
                                                <div class="row pt-60">
	                                                <div class="col-md-6">
	                                                		<h4 class="fw-800">Frequency of Positive Reviews</h4>
	                                                		<canvas id="posline"></canvas>
	                                            	</div>
	                                            	<div class="col-md-6">
	                                                		<h4 class="fw-800">Frequency of Neutral Reviews</h4>
	                                                		<canvas id="neuline"></canvas>
	                                            	</div>
	                                            </div>
	                                            <div class="row pt-60">
	                                                <div class="col-md-6">
	                                                		<h4 class="fw-800">Frequency of Negative Reviews</h4>
	                                                		<canvas id="negline"></canvas>
	                                            	</div>
	                                            	<div class="col-md-6">
	                                                		<h4 class="fw-800">Comparison of Reviews</h4>
	                                                		<canvas id="pnline"></canvas>
	                                            	</div>
	                                            </div>
											</div>
										
											
										</div>
                                    </div>
                                    
								</div>

								<!--end::Portlet-->

								
								

								<!--end::Portlet-->

								<!--begin::Portlet-->
								

								<!--end::Portlet-->
							</div>
						</div>
					</div>
					{% endif %}
				</div>
			</div>

			<!-- end:: Body -->

			<!-- begin::Footer -->
			<footer class="m-grid__item		m-footer ">
				<div class="m-container m-container--fluid m-container--full-height m-page__container">
					<div class="m-stack m-stack--flex-tablet-and-mobile m-stack--ver m-stack--desktop">
						<div class="m-stack__item m-stack__item--left m-stack__item--middle m-stack__item--last">
							<span class="m-footer__copyright">
								2020 &copy;  SIH Project
							</span>
						</div>
						
					</div>
				</div>
			</footer>

			<!-- end::Footer -->
		</div>

		<!-- end:: Page -->

		
		<!-- begin::Scroll Top -->
		<div id="m_scroll_top" class="m-scroll-top">
			<i class="la la-arrow-up"></i>
		</div>

		<!-- end::Scroll Top -->

		<!--begin::Global Theme Bundle -->
		<script src="{% static 'assets/vendors/base/vendors.bundle.js' %}" type="text/javascript"></script>
		<script src="{% static 'assets/demo/default/base/scripts.bundle.js' %}" type="text/javascript"></script>

		<!--end::Global Theme Bundle -->

		<!--begin::Page Vendors -->
		<script src="{% static 'assets/vendors/custom/fullcalendar/fullcalendar.bundle.js' %}" type="text/javascript"></script>

		<!--end::Page Vendors -->

		<!--begin::Page Scripts -->
		<script src="{% static 'assets/app/js/dashboard.js' %}" type="text/javascript"></script>
		<!--end::Page Scripts -->
		<script>
			//var vaderData = {{ sentiment_list|safe }}
			var numReviews = {{ num_of_reviews_sentiment|safe }}
			var partionedData = {{ partitionend_sentiments_dict|safe }}
			
			console.log(partionedData);

			var posList = Object.values(partionedData['positive']);
			var neuList = Object.values(partionedData['neutral']);
			var negList = Object.values(partionedData['negative']);
			var glabel = ['0-9','10-19','20-29','30-39','40-49','50-59','60-69','70-79','80-89','90-100']
			// var posList = vaderData.positive.map(x => Math.round(x*10000)/100);
			// var neuList = vaderData.neutral.map(x => Math.round(x*10000)/100);
			// var negList = vaderData.negative.map(x => Math.round(x*10000)/100);
			//console.log(Object.values(posList))
			$("#mydonut").length&&Morris.Donut( {
                element:"mydonut", data:[ {
                    label: "Positive", value: numReviews['positive']
                }
                , {
                    label: "Negative", value: numReviews['negative']
                }
                , {
                    label: "Neutral", value: numReviews['neutral']
                }
                ], labelColor:"#a7a7c2", colors:[mApp.getColor("success"), mApp.getColor("danger"), mApp.getColor("warning")]
            }
			),
			$(".positive_donut").html(numReviews["positive"]+" Positive Review(s)");
			$(".neutral_donut").html(numReviews["neutral"]+" Neutral Review(s)");
			$(".negative_donut").html(numReviews["negative"]+" Negative Review(s)");

			var ctxpos = $("#posline");
			var ctxneu = $("#neuline");
			var ctxneg = $("#negline");
			var ctxpn = $("#pnline");
			var lc1 = new Chart(ctxpos, {
			    type: 'bar',
			    
			    data: {
			    	labels:glabel,
			    	datasets:[{
			    		label : 'Positive Reviews',
			    		data: posList,
			    		backgroundColor: "rgb(52,191,163,0.4)",
				        borderColor: "rgb(52,191,163)",
				        borderWidth: 2,
				        
			    	}]
			    },
			    options:{}
			});
			var lc2 = new Chart(ctxneu, {
			    type: 'bar',
			    
			    data: {
			    	labels:glabel,
			    	datasets:[{
			    		label : 'Neutral Reviews',
			    		data: neuList,
			    		backgroundColor: "rgb(255,184,34,0.4)",
				        borderColor: "rgb(255,184,34)",
				        borderWidth: 2,
				        
			    	}]
			    },
			    options:{}
			});
			var lc3 = new Chart(ctxneg, {
			    type: 'bar',
			    
			    data: {
			    	labels:glabel,
			    	datasets:[{
			    		label : 'Negative Reviews',
			    		data: negList,
			    		backgroundColor: "rgb(244, 81, 108,0.4)",
				        borderColor: "rgb(244, 81, 108)",
				        borderWidth: 2,
				        
			    	}]
			    },
			    options:{}
			});
			var lc4 = new Chart(ctxpn, {
			    type: 'bar',
			    
			    data: {
			    	labels:glabel,
			    	datasets:[
				    	{
				    		label : 'Positive Reviews',
				    		data: posList,
				    		backgroundColor: "rgb(52,191,163,0.4)",
					        borderColor: "rgb(52,191,163)",
					        borderWidth: 2,
					        
				    	},
				    	{
				    		label : 'Neutral Reviews',
				    		data: neuList,
				    		backgroundColor: "rgb(255,184,34,0.4)",
					        borderColor: "rgb(255,184,34)",
					        borderWidth: 2,
					        
				    	},
				    	{
				    		label : 'Negative Reviews',
				    		data: negList,
				    		backgroundColor: "rgb(244, 81, 108,0.4)",
					        borderColor: "rgb(244, 81, 108)",
					        borderWidth: 2,
					        
				    	}
			    	]
			    },
			    options:{}
			});
			
		</script>

		<script>
		function logout() {
			document.getElementById('logout').submit();
		}
	</script>
	</body>

	<!-- end::Body -->
</html>